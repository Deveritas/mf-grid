!function(){Array.prototype.remove=Array.prototype.remove||function(a,b){var c=this.slice((b||a)+1||this.length);return this.length=0>a?this.length+a:a,this.push.apply(this,c)};var a=function(a,b){this.$parse=a,this.$interpolate=b,this._data=[],this.enabledColumns=[],this.selectedItems=[],this.visibleData=[],this.columnDefs=[]},b={};b.guessSortFn=function(a){var c=typeof a;switch(c){case"number":return b.sortNumber;case"boolean":return b.sortBool;case"string":return a.match(/^[-+]?[£$¤]?[\d,.]+%?$/)?b.sortNumberStr:b.sortAlpha;default:return"[object Date]"===Object.prototype.toString.call(a)?b.sortDate:b.basicSort}},b.basicSort=function(a,b){return a===b?0:b>a?-1:1},b.sortNumber=function(a,b){return a-b},b.sortNumberStr=function(a,b){var c,d,e=!1,f=!1;return c=parseFloat(a.replace(/[^0-9.-]/g,"")),isNaN(c)&&(e=!0),d=parseFloat(b.replace(/[^0-9.-]/g,"")),isNaN(d)&&(f=!0),e&&f?0:e?1:f?-1:c-d},b.sortAlpha=function(a,b){var c=a.toLowerCase(),d=b.toLowerCase();return c===d?0:d>c?-1:1},b.sortDate=function(a,b){var c=a.getTime(),d=b.getTime();return c===d?0:d>c?-1:1},b.sortBool=function(a,b){return a&&b?0:a||b?a?1:-1:0},a.prototype={_data:null,columnDefs:null,enabledColumns:null,selectedItems:null,allItemsSelected:!1,$parse:null,visibleData:null,itemsBefore:0,itemsAfter:0,pixelsBefore:0,height:0,viewportHeight:0,headerRowHeight:0,rowHeight:30,scrollTop:0,sortColumn:null,_prevSortColumn:null,_prevSortAsc:!1,sortAsc:!0,_oldLength:0,headerColumnClick:null,rowClick:null,getColumnValueRaw:function(a,b,c){return"string"==typeof b.valueRaw?a[b.valueRaw]:b.valueRaw(c||{},a)},getColumnValue:function(a,b,c){return"undefined"==typeof b.valueFiltered?this.getColumnValueRaw(a,b,c):"string"==typeof b.valueFiltered?a[b.valueFiltered]:b.valueFiltered(a)},sortByColumn:function(a,c){var d=this;if(this._prevSortColumn===a){if(this._prevSortAsc===c)return;return this._prevSortAsc=c,this._data.reverse(),void 0}this._prevSortAsc=c,this._prevSortColumn=this.sortColumn=a;var e=a.sortFn;this._data.sort(function(c,f){c=d.getColumnValueRaw(c,a),f=d.getColumnValueRaw(f,a);var g="undefined"!=typeof c&&null!==c,h="undefined"!=typeof f&&null!==f;return g||h?g&&!h?-1:!g&&h?1:("undefined"==typeof e&&(e=b.guessSortFn(c)),e(c,f)):0})},isColumnSortable:function(a){return this.enableSorting&&a.sortable},getCheckboxColumnWidth:function(){return"30px"},getColumnStyle:function(a){return{width:a.width}},setViewportHeight:function(a){this.viewportHeight=a,this.updateVisibleItems()},setHeaderRowHeight:function(a){this.headerRowHeight=a,this.updateVisibleItems()},setScrollTop:function(a){this.scrollTop=a,this.updateVisibleItems()},setVisibleItems:function(a){for(var b=0,c=a.length;c>b;++b)"undefined"==typeof this.visibleData[b]&&(this.visibleData[b]={}),this.visibleData[b].item=a[b];this.visibleData.length=a.length},updateVisibleItems:function(){var a=this.rowHeight,b=this.viewportHeight,c=this._data.length,d=Math.ceil(b/a);if(this.totalHeight=c*a,d>=c)return this.pixelsAfter=this.itemsBefore=this.pixelsBefore=this.itemsAfter=0,this.setVisibleItems(this._data),void 0;var e=5,f=Math.max(this.scrollTop,0),g=Math.floor(f/a),h=Math.min(e,g);this.itemsBefore=g-h,this.pixelsBefore=this.itemsBefore*a;var i=Math.min(this.itemsBefore+d+(e+h),c);this.itemsAfter=c-i,this.pixelsAfter=this.itemsAfter*a,this.setVisibleItems(this._data.slice(this.itemsBefore,i))},isItemSelected:function(a){return-1!==this.selectedItems.indexOf(a)},updateCheckAll:function(){this.allItemsSelected=this._data.length===this.selectedItems.length},selectItem:function(a,b){var c=this.selectedItems.indexOf(a),d=-1!==c;b&&d||!b&&!d||(b?this.selectedItems.push(a):this.selectedItems.remove(c),this.updateCheckAll())},selectAll:function(a){if(!a)return this.allItemsSelected=!1,this.selectedItems.length=0,void 0;for(var b=0,c=this._data.length;c>b;++b)this.selectedItems.push(this._data[b]);this.allItemsSelected=!0},buildColumn:function(a){return"string"==typeof a?a={displayName:a,field:a,orderBy:a,valueFiltered:a,valueRaw:a}:("undefined"!=typeof a.cellFilter&&a.cellFilter.length>0&&"undefined"==typeof a.valueFiltered&&(a.valueFiltered=this.$interpolate("{{ "+a.field+" | "+a.cellFilter+" }}")),"undefined"==typeof a.valueRaw&&(a.valueRaw=this.$parse(a.field))),"undefined"==typeof a.sortable&&(a.sortable=!0),a},setData:function(a){var b=this._data!==a||this._oldLength!==a.length;(null===a||"undefined"==typeof a)&&(a=[]),this._data=a,this._oldLength=a.length;for(var c=[],d=0,e=this.selectedItems.length;e>d;++d){var f=this.selectedItems[d];-1!==a.indexOf(f)&&c.push(f)}this.selectedItems=c,this.allItemsSelected=!1,this.enabledColumns=[];var g=this.columnDefs;if(g)for(var h=0,e=g.length;e>h;++h){var i=this.buildColumn(g[h]);this.ignoreColumns&&this.ignoreColumns.hasOwnProperty(i.field)||this.enabledColumns.push(i)}else for(var j in a[0])this.enabledColumns.push(this.buildColumn(j));b&&this.sortColumn&&this.sortByColumn(this.sortColumn),this.updateVisibleItems()}},angular.module("mf-grid",[]).controller("MfGridCtrl",["$parse","$interpolate",function(b,c){return new a(b,c)}])}(),function(){var a='<tr class="grid-row"><th ng-if="grid.showSelectionCheckbox" ng-style="{ width: grid.getCheckboxColumnWidth() }" resizable="false" class="grid-column"><input ng-checked="grid.allItemsSelected" title="Select All" type="checkbox" class="check-all" /></th><th ng-repeat="column in grid.enabledColumns" ng-style="grid.getColumnStyle(column)" ng-bind="column.displayName" ng-click="headerColumnClick(column, $index)" class="grid-column"><span ng-show="grid.sortColumn" class="grid-sort-icon icon-chevron-{{ search.dir ? \'down\' : \'up\' }}"></span></th></tr>',b='<tr mf-grid-row ng-repeat="row in grid.visibleData" ng-click="rowClick(row.item, itemIndex)" class="grid-row"><td ng-if="grid.showSelectionCheckbox" ng-style="{ width: grid.getCheckboxColumnWidth() }" class="grid-column"><input name="{{ grid.selectionCheckboxInputName }}" value="{{ row.item[grid.selectionCheckboxInputValue] }}" ng-checked="grid.isItemSelected(row.item)" type="checkbox" /></td><td ng-repeat="column in grid.enabledColumns" ng-style="grid.getColumnStyle(column)" ng-bind="grid.getColumnValue(row.item, column, $parent)" class="grid-column"></td></tr>';angular.module("mf-grid").directive("mfGrid",["$parse","$http","$templateCache","$compile","$timeout","$window",function(c,d,e,f,g,h){function i(c,i,j,k){function l(){k.setViewportHeight(p.height())}function m(){l(),c.$apply()}function n(){k.setScrollTop(s.scrollTop),c.$apply()}function o(a){return a.closest(".grid-row").scope().row.item}var p=i.find(".grid-viewport"),q=i.find(".grid-header"),r=i.find(".grid-body"),s=i.find(".grid-viewport").get(0);k.rowHeight=parseInt(k.rowHeight,10)||50,c.$watchCollection("$parent."+k.data,function(a){k.setData(a)}),c.$watchCollection("grid.columnDefs",function(){k.setData(k._data)}),c.$watchCollection("grid.selectedItems",function(){k.updateCheckAll(),k.selectionChanged&&k.selectionChanged(k.selectedItems)});var t=angular.element(h);t.on("resize",m),c.$on("$destroy",function(){t.off("resize",m)}),c.$watch("grid.height",function(a){a&&i.height(a),g(function(){l()})}),c.$watch("grid.headerRowHeight",function(a){k.headerRowHeight&&q.find(".grid-row").height(a),k.setHeaderRowHeight(q.find(".grid-row").height()),p.css({top:k.headerRowHeight})}),c.headerColumnClick=function(a,b){k.sortColumn=a,k.sortAsc=k.sortColumn===a?!k.sortAsc:!0,"function"==typeof k.headerColumnClick?k.headerColumnClick("string"==typeof a.value?a.value:a,b,k.sortAsc):k.sortByColumn(a,k.sortAsc)},c.rowClick=function(a,b){k.rowClick&&k.rowClick(a,b)},i.find(".grid-viewport").on("scroll",n),q.on("click","input.check-all",function(){k.selectAll(this.checked),c.$apply()}),r.on("click",".grid-column",function(a){if(!$(a.target).is(":not(.grid-column)")){var b=$(this),d=b.find("input:checkbox");d.length>0&&(a.stopImmediatePropagation(),k.selectItem(o(d),!d[0].checked)),c.$apply()}}),r.on("click","input:checkbox",function(a){a.stopImmediatePropagation(),k.selectItem(o(angular.element(this)),this.checked),c.$apply()}),k.rowTemplateUrl||k.rowTemplate||(k.rowTemplate=b),k.rowTemplate?r.append(f(k.rowTemplate)(c)):d.get(k.rowTemplateUrl,{cache:e}).success(function(a){r.append(f(a)(c))}),k.headerRowTemplateUrl||k.headerRowTemplate||(k.headerRowTemplate=a),k.headerRowTemplate?q.find("thead").append(f(k.headerRowTemplate)(c)):d.get(k.headerRowTemplateUrl,{cache:e}).success(function(a){q.find("thead").append(f(a)(c))})}return{restrict:"A",scope:{grid:"=mfGrid"},replace:!0,controller:"MfGridCtrl",templateUrl:"views/mf-grid.html",link:function(a,b,c,d){var e=a.grid||{};for(var f in e)e.hasOwnProperty(f)&&(d[f]=e[f]);a.grid=d,i(a,b,c,d)}}}]).directive("mfGridRow",["$compile","$http","$templateCache",function(){return{restrict:"A",require:"^mfGrid",compile:function(){return{post:function(a,b,c,d){b.find(".grid-column").height(d.rowHeight),a.$watch("grid.itemsBefore",function(b){a.itemIndex=b+a.$index})}}}}}])}();